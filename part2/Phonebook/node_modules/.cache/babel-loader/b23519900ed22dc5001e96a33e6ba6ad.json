{"ast":null,"code":"import _objectSpread from\"/home/khiem/fullstackopen/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/home/khiem/fullstackopen/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from'react';import axios from'axios';import phoneService from'./module/phone';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var App=function App(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),persons=_useState2[0],setPersons=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),newName=_useState4[0],setNewName=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),newNumber=_useState6[0],setNewNumber=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),filter=_useState8[0],setFilter=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),successMessage=_useState10[0],setSuccessMessage=_useState10[1];var _useState11=useState(''),_useState12=_slicedToArray(_useState11,2),errorMessage=_useState12[0],setErrorMessage=_useState12[1];useEffect(function(){phoneService.getAll().then(function(initial){setPersons(initial);});},[]);var addName=function addName(event){event.preventDefault();var nameNumberObject={name:newName,number:newNumber,id:persons.length+1};var checkName=persons.find(function(person){return person.name===newName;});var changeNumber=_objectSpread(_objectSpread({},checkName),{},{number:newNumber});if(!checkName){phoneService.create(nameNumberObject).then(function(addPhone){setSuccessMessage(\"Added \".concat(nameNumberObject.name));setTimeout(function(){setSuccessMessage(null);},3000);setPersons(persons.concat(addPhone));setNewName('');setNewNumber('');}).catch(function(error){return console.log(error);});}else if(window.confirm(\"\".concat(checkName.name,\" is already added to phonebook,\\n    replace the number with the new one?\"))){phoneService.update(checkName.id,changeNumber).then(function(newNumber){setPersons(persons.map(function(p){return p.id===checkName.id?newNumber:p;}));});}};var handleDelete=function handleDelete(id){var url='http://localhost:3001/persons';var name=persons.find(function(name){return name.id===id;});if(window.confirm(\"Delete \".concat(name.name,\"?\"))){axios.delete(\"\".concat(url,\"/\").concat(id)).then(function(){return setPersons(persons.filter(function(p){return p.id!==id;}));}).catch(function(){setErrorMessage(\"Information of \".concat(name.name,\" has already delete from server\"));setTimeout(function(){setErrorMessage(null);},3000);setPersons(persons.filter(function(person){return person.id!==id;}));});}};var handleNameChange=function handleNameChange(event){setNewName(event.target.value);};var handleNumberChange=function handleNumberChange(event){setNewNumber(event.target.value);};var filterName=function filterName(event){setFilter(event.target.value);};var search=filter?persons.filter(function(person){return person.name.toLowerCase().includes(filter.toLowerCase());}):persons;return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Phone book\"}),/*#__PURE__*/_jsx(Success,{message:successMessage}),/*#__PURE__*/_jsx(Error,{message:errorMessage}),/*#__PURE__*/_jsx(Filter,{value:filter,filterName:filterName}),/*#__PURE__*/_jsx(\"h1\",{children:\"Add a new\"}),/*#__PURE__*/_jsx(PersonForm,{addName:addName,newName:newName,handleNameChange:handleNameChange,newNumber:newNumber,handleNumberChange:handleNumberChange}),/*#__PURE__*/_jsx(\"h1\",{children:\"Numbers\"}),search.map(function(person){return/*#__PURE__*/_jsx(Persons,{persons:person.name,number:person.number,handle:function handle(){return handleDelete(person.id);}},person.id);})]});};var Success=function Success(_ref){var message=_ref.message;if(message){return/*#__PURE__*/_jsx(\"div\",{className:\"notifMgs1\",children:/*#__PURE__*/_jsx(\"h2\",{className:\"success\",children:message})});}return/*#__PURE__*/_jsx(\"div\",{});};var Error=function Error(_ref2){var message=_ref2.message;if(message){return/*#__PURE__*/_jsx(\"div\",{className:\"notifMgs2\",children:/*#__PURE__*/_jsx(\"h2\",{className:\"error\",children:message})});}return/*#__PURE__*/_jsx(\"div\",{});};var Filter=function Filter(_ref3){var value=_ref3.value,filterName=_ref3.filterName;return/*#__PURE__*/_jsxs(\"div\",{children:[\"filter show with: \",/*#__PURE__*/_jsx(\"input\",{value:value,onChange:filterName})]});};var Persons=function Persons(_ref4){var persons=_ref4.persons,number=_ref4.number,handle=_ref4.handle;return/*#__PURE__*/_jsxs(\"p\",{children:[persons,\" \",number,/*#__PURE__*/_jsx(\"button\",{onClick:handle,children:\"delete\"})]});};var PersonForm=function PersonForm(props){return/*#__PURE__*/_jsxs(\"form\",{onSubmit:props.addName,children:[/*#__PURE__*/_jsxs(\"div\",{children:[\"name: \",/*#__PURE__*/_jsx(\"input\",{value:props.newName,onChange:props.handleNameChange}),/*#__PURE__*/_jsxs(\"div\",{children:[\"number: \",/*#__PURE__*/_jsx(\"input\",{value:props.newNumber,onChange:props.handleNumberChange})]})]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"add\"})})]});};export default App;","map":{"version":3,"names":["useState","useEffect","axios","phoneService","App","persons","setPersons","newName","setNewName","newNumber","setNewNumber","filter","setFilter","successMessage","setSuccessMessage","errorMessage","setErrorMessage","getAll","then","initial","addName","event","preventDefault","nameNumberObject","name","number","id","length","checkName","find","person","changeNumber","create","addPhone","setTimeout","concat","catch","error","console","log","window","confirm","update","map","p","handleDelete","url","delete","handleNameChange","target","value","handleNumberChange","filterName","search","toLowerCase","includes","Success","message","Error","Filter","Persons","handle","PersonForm","props"],"sources":["/home/khiem/fullstackopen/part2/Phonebook/src/App.js"],"sourcesContent":["import { useState, useEffect } from 'react'\nimport axios from 'axios'\nimport phoneService from './module/phone'\n\n\nconst App = () => {\n  const [persons, setPersons] = useState([])\n  const [newName, setNewName] = useState('')\n  const [newNumber, setNewNumber] = useState('')\n  const [filter, setFilter] = useState('')\n  const [successMessage, setSuccessMessage] = useState('')\n  const [errorMessage, setErrorMessage] = useState('')\n\n  useEffect(() => {\n    phoneService\n      .getAll()\n      .then(initial => {\n        setPersons(initial)\n      })\n  }, [])\n\n\n  const addName = (event) => {\n    event.preventDefault()\n    const nameNumberObject = {\n      name: newName,\n      number: newNumber,\n      id: persons.length + 1\n    }\n    const checkName = persons.find(person => person.name === newName)\n    const changeNumber = { ...checkName, number: newNumber }\n\n    if (!checkName) {\n      phoneService\n        .create(nameNumberObject)\n        .then(addPhone => {\n          setSuccessMessage(`Added ${nameNumberObject.name}`)\n          setTimeout(() => {\n            setSuccessMessage(null)\n          }, 3000)\n          setPersons(persons.concat(addPhone))\n          setNewName('')\n          setNewNumber('')\n        })\n        .catch(error => console.log(error))\n    } else if (window.confirm(`${checkName.name} is already added to phonebook,\n    replace the number with the new one?`)) {\n      phoneService\n        .update(checkName.id, changeNumber)\n        .then(newNumber => {\n          setPersons(persons.map(p => p.id === checkName.id ? newNumber : p))\n        })\n    }\n  }\n\n  const handleDelete = (id) => {\n    const url = 'http://localhost:3001/persons'\n    const name = persons.find(name => name.id === id)\n\n    if (window.confirm(`Delete ${name.name}?`)) {\n      axios\n        .delete(`${url}/${id}`)\n        .then(() => setPersons(persons.filter(p => p.id !== id)))\n        .catch(() => {\n          setErrorMessage(`Information of ${name.name} has already delete from server`)\n          setTimeout(() => {\n            setErrorMessage(null)\n          }, 3000)\n          setPersons(persons.filter(person => person.id !== id))\n        })\n    }\n  }\n\n  const handleNameChange = (event) => {\n    setNewName(event.target.value)\n  }\n\n  const handleNumberChange = (event) => {\n    setNewNumber(event.target.value)\n  }\n\n  const filterName = (event) => {\n    setFilter(event.target.value)\n  }\n  const search = filter\n    ? persons.filter(person =>\n      person.name.toLowerCase().includes(filter.toLowerCase()))\n    : persons\n\n\n  return (\n    <div>\n      <h1>Phone book</h1>\n      <Success message={successMessage} />\n      <Error message={errorMessage} />\n      <Filter value={filter} filterName={filterName} />\n      <h1>Add a new</h1>\n      <PersonForm\n        addName={addName}\n        newName={newName} handleNameChange={handleNameChange}\n        newNumber={newNumber} handleNumberChange={handleNumberChange}\n      />\n      <h1>Numbers</h1>\n      {search.map(person =>\n        <Persons\n          key={person.id}\n          persons={person.name}\n          number={person.number}\n          handle={() => handleDelete(person.id)}\n        />\n      )}\n    </div >\n  )\n}\n\nconst Success = ({ message }) => {\n  if (message) {\n    return (\n      <div className='notifMgs1'>\n        <h2 className='success'>\n          {message}\n        </h2>\n      </div>\n    )\n  }\n  return <div></div>\n}\nconst Error = ({ message }) => {\n  if (message) {\n    return (\n      <div className='notifMgs2'>\n        <h2 className='error'>\n          {message}\n        </h2>\n      </div>\n    )\n  }\n  return <div></div>\n}\n\n\nconst Filter = ({ value, filterName }) => {\n  return (\n    <div>\n      filter show with: <input value={value} onChange={filterName} />\n    </div>\n  )\n}\n\nconst Persons = ({ persons, number, handle }) => {\n  return (\n    <p>\n      {persons} {number}\n      <button onClick={handle}>\n        delete</button>\n    </p>\n  )\n}\n\nconst PersonForm = (props) => {\n  return (\n    <form onSubmit={props.addName}>\n      <div>\n        name: <input\n          value={props.newName}\n          onChange={props.handleNameChange} />\n        <div>\n          number: <input\n            value={props.newNumber}\n            onChange={props.handleNumberChange} />\n        </div>\n      </div>\n      <div>\n        <button type=\"submit\">add\n        </button>\n      </div>\n    </form>\n  )\n}\n\nexport default App"],"mappings":"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"},"metadata":{},"sourceType":"module"}